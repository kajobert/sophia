#!/bin/bash
# SOPHIA Start Command
SOPHIA_DIR="$(cd "$(dirname "$0")/.." && pwd)"
cd "$SOPHIA_DIR" || exit 1

if pgrep -f "python.*run.py" > /dev/null; then
    echo "‚ö†Ô∏è  SOPHIA ji≈æ bƒõ≈æ√≠!"
    exit 1
fi

echo "üöÄ Spou≈°t√≠m SOPHII..."
nohup .venv/bin/python run.py --ui classic > /tmp/sophia.log 2>&1 &
PID=$!

echo "‚úÖ SOPHIA spu≈°tƒõna (PID: $PID)"
echo "üìä Dashboard: http://127.0.0.1:8000/dashboard"
echo "Poƒçkej 30s na inicializaci..."

sleep 30
if curl -s http://127.0.0.1:8000/api/stats > /dev/null 2>&1; then
    echo "‚úÖ SOPHIA bƒõ≈æ√≠ a odpov√≠d√°!"
else
    echo "‚ö†Ô∏è  Zkontroluj logy: tail -f /tmp/sophia.log"
fi
